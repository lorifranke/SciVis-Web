W26–W34 Nucleic Acids Research, 2019, Vol. 47, Web Server issue                                                         Published online 22 May 2019
doi: 10.1093/nar/gkz394


Web 3DNA 2.0 for the analysis, visualization, and
modeling of 3D nucleic acid structures
Shuxiang Li1 , Wilma K. Olson1,* and Xiang-Jun Lu2,*
1
 Department of Chemistry & Chemical Biology and Center for Quantitative Biology, Rutgers, the State University of
New Jersey, Piscataway, NJ 08854, USA and 2 Department of Biological Sciences, Columbia University, New York,
NY 10027, USA




                                                                                                                                                                  Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
Received March 15, 2019; Revised April 23, 2019; Editorial Decision April 30, 2019; Accepted May 01, 2019



ABSTRACT                                                                          INTRODUCTION
Web 3DNA (w3DNA) 2.0 is a significantly enhanced                                  In addition to carrying genetic information, nucleic acids
version of the widely used w3DNA server for the anal-                             contain structural, regulatory, and enzymatic signals related
ysis, visualization, and modeling of 3D nucleic-acid-                             to their cellular functions. Understanding the structural fea-
containing structures. Since its initial release in 2009,                         tures of DNA and RNA at the atomic level is crucial for
the w3DNA server has continuously served the com-                                 deciphering the ‘codes’ of gene expression/regulation, and
                                                                                  for designing new therapeutics and nanomaterials. Experi-
munity by making commonly-used features of the
                                                                                  mentally determined 3D structural information about nu-
3DNA suite of command-line programs readily acces-                                cleic acids is available from the Protein Data Bank (PDB)
sible. However, due to the lack of updates, w3DNA                                 (1) and the dedicated Nucleic Acid Database (NDB) (2). Ex-
has clearly shown its age in terms of modern web                                  ploration of 3D nucleic acid structures involves three closely
technologies and it has long lagged behind further                                related components: analysis, visualization, and modeling
developments of 3DNA per se. The w3DNA 2.0 server                                 of molecular conformation, dynamics, and interactions.
presented here overcomes all known shortcomings                                   3DNA (3–5) is an integrated suite of computer programs
of w3DNA while maintaining its battle-tested charac-                              with capabilities in each of these categories. Over the years,
teristics. Technically, w3DNA 2.0 implements a sim-                               3DNA has been widely used, and adopted in many bioin-
ple and intuitive interface (with sensible defaults)                              formatics resources, including the NDB.
                                                                                     3DNA, along with Curves+ (6), is one of the most
for increased usability, and it complies with HTML5
                                                                                  popular software products for the analysis of DNA/RNA
web standards for broad accessibility. Featurewise,
                                                                                  double-helical structures. Moreover, by adopting the same
w3DNA 2.0 employs the most recent version of 3DNA,                                standard base reference frame (7), the two programs yield
enhanced with many new functionalities, including:                                similar numerical values for the rigid-body parameters used
the automatic handling of modified nucleotides; a set                             to describe the 3D arrangements of the complementary
of ‘simple’ base-pair and step parameters for quali-                              bases within Watson–Crick (WC) base pairs and the steps
tative characterization of non-Watson–Crick double-                               taken by successive WC base pairs (bp) along double-
helical structures; new structural parameters that                                helical structures (8). 3DNA and Curves+, however, di-
integrate the rigid base plane and the backbone                                   verge from one another in the analysis of non-WC pairs,
phosphate group, the two nucleic acid components                                  and they provide different characterizations of groove di-
most reliably determined with X-ray crystallography;                              mensions and helical distortions. 3DNA also stands out
                                                                                  among the most popular nucleic-acid model building tools,
in silico base mutations that preserve the back-
                                                                                  using local bp and step parameters for customized con-
bone geometry; and a notably improved module for
                                                                                  struction of arbitrary nucleic acid structures, and a ‘fiber’
building models of single-stranded RNA, double-                                   (9) component for easy generation of over fifty types of
helical DNA, Pauling triplex, G-quadruplex, or DNA                                uniform helical structures. By contrast, the Nucleic Acid
structures ‘decorated’ with proteins. The w3DNA 2.0                               Builder (NAB) (10) employs a combination of rigid-body
server is freely available, without registration, at                              transformations and distance geometry to generate helical
http://web.x3dna.org.                                                             and unusual, non-helical DNA and RNA structures. Like
                                                                                  3DNA, the NUPARM/NUCGEN software (11) and the
                                                                                  updated RNAHelix modeling program (12) allow for the

* To
   whom correspondence should be addressed. Tel: +1 732 447 7806; Fax: +1 212 865 8246; Email: xiangjun@x3dna.org
Correspondence may also be addressed to Wilma K. Olson. Email: wilma.olson@rutgers.edu

C The Author(s) 2019. Published by Oxford University Press on behalf of Nucleic Acids Research.
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License
(http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work
is properly cited. For commercial re-use, please contact journals.permissions@oup.com
                                                                   Nucleic Acids Research, 2019, Vol. 47, Web Server issue W27


analysis and construction of sequence-dependent nucleic              quickly get started using a browser (such as Chrome, Sa-
acid structures in terms of local bp parameters. NUPARM,             fari, or Firefox) on desktops, tablets, or smartphones. Fea-
however, calculates bp parameters differently from 3DNA              turewise, w3DNA 2.0 employs the most recent version of
(5,13), which is unique for the rigorous reversibility of its        3DNA which is enhanced with many new functionalities, in-
analysis/rebuilding routines. In addition, 3DNA offers a             cluding: (i) the automatic handling of modified nucleotides,
characteristic base-block representation of a nucleic acid           which streamlines the analysis process; (ii) a set of ‘simple’
structure that is both simple and informative for visualiza-         bp and step parameters for qualitative characterization of
tion. These schematic images are used by both the PDB and            non-WC double-helical structures (Figure 1B, and Supple-
the NDB. Please refer to Supplemental Data S5 for a list of          mentary Data S1); (iii) new structural parameters that in-
related external resources.                                          tegrate the rigid base plane and the backbone phosphate
   The web 3DNA (w3DNA) server (14) makes commonly-                  group, the two nucleic acid components most reliably de-
used features of the 3DNA suite of command-line programs             termined with X-ray crystallography (Figure 2 and Supple-




                                                                                                                                         Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
readily accessible. Other web servers for nucleic acid struc-        mentary Data S3); (iv) high resolution images of the base-
tures include the Curves+ web server (15) for analysis, 3D-          block schematic representation of each nucleic acid struc-
DART (16), and the ‘make-na’ server (10), built on top of            ture (cf. with those in the PDB and NDB) and interactive
NAB, for modeling (Supplemental Data S5). Nevertheless,              visualization of the same with JSmol (22); (v) restraint op-
w3DNA stands out for its convenience in use, and a rich set          timization of backbone geometry (23) of models from cus-
of features for analysis, rebuilding, and visualization. Since       tomized rebuilding (Figure 1D and E); (vi) in silico base mu-
its initial release in 2009, w3DNA has continuously served           tations that preserve the backbone geometry (Figure 3E and
the community with virtually no changes. At the time of this         F) and (vii) a notably improved module for building models
writing, the server has been cited over 230 times (includ-           of single-stranded RNA, duplex DNA, G-quadruplex, and
ing 34 times in 2018), according to Google Scholar. Recent           DNA structures ‘decorated’ with proteins (Figures 1D, 1E,
citations to w3DNA include: calculations of the DNA he-              and 3B-F).
lical axis and twist angles (17), determination of the con-             Indeed, during its nearly two decades of evolution,
formational parameters of DNA bound to PfoI and other                3DNA has accumulated more features than a typical user
CCGG-family restriction endonucleases (18), and genera-              may care to employ (Figures 1-3) and a non-expert user can
tion of initial atomistic duplex and triplex models (19,20)          get lost in the details of the numerous conformational pa-
for molecular dynamics simulations.                                  rameters (e.g. ‘global’ versus ‘local’ versus ‘simple’). To help
   Due to the lack of updates, however, w3DNA has clearly            users become oriented with the interface, the w3DNA 2.0
shown its age in terms of modern web technologies, and               server contains a complete set of tutorials (Supplementary
it has long lagged behind further developments of 3DNA               Data S4), and each feature has a help icon linked to the cor-
per se (3,21). For example, w3DNA uses a fixed list of               responding tutorial section. The Supplementary Data also
modified nucleotides mapped to their canonical counter-              provide concrete examples of new structural parameters
parts (e.g. 5-methylcytidine [5MC] to ‘c’, expressed as a            (Sections S1 and S3) and sample input files for the ‘Rebuild-
lower-case letter to distinguish it from the standard ‘C’).          ing’ module (Section S2). The website is further enhanced
The list was compiled from an analysis of all entries in             with pictorial illustrations and annotations of pertinent pa-
the NDB around 2009, covering the most common cases.                 rameters in the ‘Analysis’ module. Mathematical details of
However, each new modified nucleotide demands a man-                 the core analysis/rebuilding algorithms can be found in the
ual update of the list, and the addition of new cases to             initial 3DNA publication (5) and references cited therein.
the list has become a frequent request at the 3DNA Fo-               Since 3DNA version 2.4 (which backs the web server) is
rum (http://forum.x3dna.org). Another well-known issue is            open source, interested users can examine the source code
the analysis of RNA or non-canonical DNA structures that             of any feature. Moreover, all user questions are always wel-
contain non-WC pairs (Supplementary Data S1). The exist-             come and promptly addressed on the 3DNA Forum. For ex-
ing set of local bp and step parameters in 3DNA is mathe-            ample, one entry on the FAQ (frequently-asked-questions)
matically rigorous, allowing for an unambiguous character-           section of the 3DNA Forum is titled ‘How to calculate a
ization of any pair of interacting bases and serving as input        DNA bending angle?’ Generally speaking, the curvature of
for exact model building. For non-WC pairs, however, the             a complicated double helix in 3D is hard to quantify and
3DNA local bp parameters sometimes become cryptic, and               difficult to visualize. For a duplex with two fragments that
the local step parameters may seem to be nonsensical. Ob-            are relatively straight, one can fit a least-squared helical axis
viously, the w3DNA server needs a major overhaul to take             to each and then derive an angle between the two as an esti-
better advantage of 3DNA and modern web technologies,                mate of the magnitude of bending, and an additional phase
and to remain useful.                                                angle for the direction of bending (S. Harvey, personal com-
   The w3DNA 2.0 server (Figure 1) presented here over-              munications, November to December 2015).
comes all known shortcomings of w3DNA while maintain-                   Overall, the new server has a streamlined interface, is
ing its battle-tested characteristics. The new web server pro-       simple to use, and comes with an unmatched set of fea-
vides a modern interactive user interface for the analysis, vi-      tures. It has the capabilities to serve a huge userbase, for
sualization, and modeling of nucleic-acid-containing struc-          both research and education. Since its public release in De-
tures. Technically, w3DNA 2.0 implements a simple and in-            cember 2018, w3DNA 2.0 has been accessed by an aver-
tuitive interface (with sensible defaults) for increased usabil-     age of ∼150 unique IP addresses each month from users
ity, and it complies with HTML5 web standards for broad              around the world, and visitor numbers keep increasing. The
accessibility. As a result, even novice or occasional users can
W28 Nucleic Acids Research, 2019, Vol. 47, Web Server issue




                                                                                                                                                                  Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
Figure 1. Summary of web 3DNA 2.0. (A) The homepage, highlighting the three major components of the server (boxed) and links to key resources. (B)
Excerpt from the ‘Analysis’ of a drug–DNA complex (PDB entry 1xvk) (38), showing a base-block image and tabulations of the ‘simple’ base-pair and
step parameters. (C) Schematic ‘Visualization’ of an ensemble of NMR structures of a protein–DNA complex (PDB entry 2moe) (31). The models are
aligned locally in the reference frame of the fifth base pair, with its minor-groove edge (colored black) facing the viewer. The protein, colored purple, binds
in the major groove of the DNA. (D) An example of ‘Rebuilding’ a model from the local base-pair and step parameters obtained from an ‘Analysis’ of a
tRNA structure (PDB entry: 1fir) (33). (E) ‘Composite’ model of a DNA ‘decorated’ with proteins. Here a nucleosome (PDB entry: 4xzq) (34) is used as a
template to construct a three-nucleosome, chromatin-like structure. Color code for base rectangular blocks: A, red; C, yellow; G, green; T, blue; U, cyan.
(B–D) were generated automatically via the 3DNA ‘blocview’ program, which calls MolScript (24) and Raster3D (25); (E) was rendered using JSmol (22).
The annotations were created using Inkscape (https://inkscape.org).


w3DNA 2.0 server is freely available, without registration,                       cluded from the database. Each selected entry has been an-
at http://web.x3dna.org.                                                          alyzed with 3DNA version 2.4 (3–5) to obtain a large set
                                                                                  of structural parameters describing base morphology and
MATERIALS AND METHODS                                                             backbone geometry. The resulting datasets are deposited in
                                                                                  tables managed by a MySQL database engine. Addition-
Datasets                                                                          ally, several text files containing various structural parame-
To facilitate the analysis of nucleic-acid-containing struc-                      ters and five schematic images of base-block representations
tures from the PDB, a very common user demand, we con-                            from diverse perspectives have been stored in a folder linked
structed a database of those entries for w3DNA 2.0. The                           to each structure.
current database is populated by all PDB entries (with meta-                         Users can also upload a PDB-formatted coordinate file
data) from the 6 March 2019 release that contain the 3D                           of a nucleic acid structure to the server. Except for a lack
coordinates, in traditional PDB format, of at least one nu-                       of metadata (such as experimental methodology or links to
cleotide. Gigantic structures, such as the ribosome, that                         external resources), the analysis pipeline and the output in-
are available only in PDBx/mmCIF format are thus ex-                              terface are similar to those for a PDB entry.
                                                                               Nucleic Acids Research, 2019, Vol. 47, Web Server issue W29




                                                                                                                                                                  Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
Figure 2. New structural parameters that connect base and backbone atoms. (A) A pair of virtual torsion angles (␩ and ␪  ) that are based on the positions
of the phosphorus atoms (P) and the origins of the intervening bases in their standard base reference frames (7). Two closely related forms of virtual backbone
torsion angles are depicted for comparison: the classic version (␩ and ␪) defined by the P and C4 atoms (27), and a more recent variant (␩ and ␪  ) based
on the P and C1 atoms (28). Here, an ApTpG trinucleotide from a B-DNA fiber model is used for illustration, with base reference frames attached. Note
that the standard base frames of purines and pyrimidines are symmetrical with respect to the dyad of an idealized Watson–Crick base pair, and thus
independent of base identity (21): the base origin is accordingly more displaced from the atoms of T (a pyrimidine) than those of A or G (purines). (B–D)
Single-stranded phosphate displacement, ssZp, in representative helical structures showing: (B) a small, positive number for a GpG step from a B-DNA
fiber model where a C2 -endo sugar attaches to a base in an anti conformation (ssZp = +1.84 Å); (C) a large, positive value for an ApA step from an RNA
fiber model where a C3 -endo sugar attaches to a base in an anti conformation (ssZp = +4.38 Å); (D) a negative value for a GpC step from a Z-DNA fiber
model where the G adopts a syn conformation (ssZp = −1.74 Å). Color code for base blocks: A, red; G, green; T, blue. The illustrations were generated
with DSSR (21) and PyMOL (https://pymol.org).


Web server                                                                        libraries, including jQuery (http://jquery.com). The server
                                                                                  has a 20 MB size limit for uploaded coordinate files. For
The w3DNA 2.0 web server is hosted at Columbia Uni-
                                                                                  DNA/RNA structures with <350 nucleotides, it normally
versity, and runs on Ubuntu Linux (16.04.6 LTS) with 128
                                                                                  takes ∼20 s for analysis, and less than 1 min for rebuild-
GB memory and a 20 TB hard drive. Other significant
                                                                                  ing with backbone optimization (or ∼5 s without optimiza-
software packages used include: Apache (version 2.4.18,
                                                                                  tion).
https://httpd.apache.org), PHP (version 7.2.15, http://www.
                                                                                     The w3DNA 2.0 server conducts computations syn-
php.net), MySQL (version 5.7.25, https://www.mysql.com),
                                                                                  chronously in the backend via a combination of embedded
JSmol (version 14.29.4) (22) for the interactive display of
                                                                                  3DNA software (version 2.4) and other components glued
3D models, and Phenix (23) (version 1.14) for the base-
                                                                                  together by ad hoc scripts. Once a user has provided a PDB
restraint optimization of backbone geometry. The base-
                                                                                  structure identifier (id) or base sequence (along with other
block schematic images were generated by calling MolScript
                                                                                  options, depending upon the chosen module; see Figure
(24) and Raster3D (25). The client-side user interface
                                                                                  1A), the backend scripts first validate the user input (e.g. a
was implemented using HTML5, the CodeIgniter PHP
                                                                                  4-letter PDB id, or A/C/G/T for a DNA base sequence).
framework (https://www.codeigniter.com/), and JavaScript
W30 Nucleic Acids Research, 2019, Vol. 47, Web Server issue


                                                                               helical fragments, and calculates a large set of bp and back-
                                                                               bone parameters. The analysis component of w3DNA 2.0
                                                                               accepts a user-provided PDB id or an uploaded, PDB-
                                                                               formatted coordinate file for structural characterization.
                                                                               For a PDB entry, the server searches the database ta-
                                                                               bles for pre-populated metadata and fetches pre-stored
                                                                               schematic images and text files. For a user-uploaded file,
                                                                               the analysis pipeline is performed anew based solely on the
                                                                               ATOM/HETATM coordinates, with no consideration of
                                                                               metadata that may exist in the coordinate file.

                                                                               Modified nucleotides. The original w3DNA server (14)




                                                                                                                                                  Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
                                                                               used a fixed list of modified nucleotides mapped to their
                                                                               canonical counterparts. This mapping process is needed to
                                                                               derive base reference frames for the calculation of bp pa-
                                                                               rameters. For example, 5-methylcytidine, named 5MC in the
                                                                               PDB, is mapped to ‘c’. The modified nucleotide is expressed
                                                                               as a lower-case letter to distinguish it from the standard nu-
                                                                               cleotide. The list (with entries like ‘5MC c’ stored in a file
                                                                               called ‘baselist.dat’) was compiled from an analysis of all en-
                                                                               tries in the NDB around 2009 and covered all modified nu-
                                                                               cleotides known experimentally at the time. Each new mod-
                                                                               ified nucleotide, however, demands a manual update of the
                                                                               list. This is cumbersome for server maintenance, and causes
                                                                               inconvenience to end users. Over the years, we have contin-
                                                                               uously revised the algorithm for the identification of mod-
                                                                               ified nucleotides and the list is no longer necessary (21). In
                                                                               w3DNA 2.0, we have adopted a middle-ground approach:
                                                                               the ‘baselist.dat’ file is checked first to allow for control of
                                                                               the mapping process. If a modified nucleotide is not found
                                                                               in the list, it is assigned automatically.

Figure 3. Commonly-used fiber models and in silico base mutations. (A)         Output sections. The output page includes five sections: (i)
Six commonly used models highlighted in the ‘Fiber’ module: single-            a structural summary (available for PDB entries) including
stranded RNA, double-helical A-, B-, and C-form DNA, the Pauling               structure title, primary citation, experimental method, and
triplex model (32), and the parallel polyI:polyI:polyI:polyI quadruplex. (B)
Single-stranded RNA fiber model of base sequence AUCGAUCGAUCG.                 links to external resources; (ii) schematic base-block repre-
(C) Double-helical B-DNA fiber model with sequence ATCGATC-                    sentations with informative color coding in five perpendicu-
GATCG on the leading strand. (D) Pauling triplex model with each strand        lar perspectives (see example in Figure 1B and below); (iii) a
of sequence AAAACCCCGGGG. (E) parallel polyI:polyI:polyI:polyI                 JSmol window for interactive visualization; (iv) files of raw
quadruplex model with 12 layers of hydrogen-bonded hypoxanthine
tetrads. Models in (B-E) were generated using the default settings on the
                                                                               parameters, including the main output file which contains a
w3DNA 2.0 server, each taking just two mouse clicks. (F) All hypoxan-          detailed description of 3DNA-derived conformational pa-
thine bases along the poly I chains mutated to guanine via the ‘Mutation’      rameters, the local bp/step parameters file that can be used
module, leading to a parallel G-quadruplex. Color code for base blocks:        for rebuilding (see below), and the (virtual) torsion angles
A, red; C, yellow; G, green; T, blue; U, cyan; I, dark green.                  file that quantifies backbone geometries and spatial connec-
                                                                               tions between the bases and backbone (see below); (v) nine
Subsequently, the server conveys appropriate 3DNA com-                         interactive Grid-View tables embracing bp/step parameters
mands for analysis, modeling, or image plotting.                               and torsion angles. See Figure 1B for two examples of such
                                                                               tables, which can be sorted interactively and downloaded in
                                                                               CSV (comma-separated values) format for further process-
RESULTS                                                                        ing.
The w3DNA 2.0 server includes six modules (Figure
1A): ‘Analysis’, ‘Visualization’, ‘Rebuilding’, ‘Composite’,                   ‘Simple’ parameters for non-WC pairs. The spatial ar-
‘Fiber’, and ‘Mutation’, the last four of which fall under the                 rangement of the two bases in a pair can be rigorously
category of model building. Each module has practical de-                      quantified by six rigid-body parameters––three translations
fault settings, so users only have to click a few buttons to                   (Shear, Stretch, and Stagger) and three rotations (Buckle,
see the main features.                                                         Propeller, and Opening). Similarly, taking each bp as a rigid
                                                                               body, a set of six step parameters (Shift, Slide, Rise for
                                                                               translations, Tilt, Roll and Twist for rotations) can be used
The ‘Analysis’ module
                                                                               to describe the relative position and orientation of neigh-
3DNA (5) identifies nucleotides including modified ones,                       boring bps. The numerical values of these local bp and
WC or non-WC pairs, co-planar base multiplets, double-                         step parameters depend upon the choice of reference frames
                                                                Nucleic Acids Research, 2019, Vol. 47, Web Server issue W31


(13). For WC pairs and DNA/RNA duplexes consisting of             new parameters take advantage of the standard base ref-
these canonical pairs, local 3DNA parameters make ‘intu-          erence frame (7), which is symmetrical with respect to the
itive’ sense (e.g. a Rise of around 3.4 Å and a Twist of 32–     dyad of an idealized Watson–Crick base pair, and indepen-
36◦ ). For non-WC pairs, however, the 3DNA local bp pa-           dent of base identity.
rameters can sometimes become cryptic, and the local step            Using the origins of the base reference frames and the
parameters may seem to be nonsensical (for example, null          positions of the phosphorus atoms (P), we define a pair of
or negative Rise values, as reported on the 3DNA Forum;           virtual angles (Figure 2A): ␩ by origin(i–1)-P(i)-origin(i)-
see Supplemental Data S1).                                        P(i+1); ␪  by P(i)-origin(i)-P(i+1)-origin(i+1). The classic
   In 2015, Richardson contributed two articles to the            virtual backbone torsion angles (␩ and ␪) are based on the
Computational Crystallography Newsletter (CCN, vol. 6,            simplification of the sugar-phosphate backbone by Olson
pp. 28–31 and pp. 47–53) on the importance of bp                  (27) in terms of the P and C4 atoms. Subsequent interpre-
non-planarity at biologically significant positions in high-      tations of low-resolution crystallographic density maps by




                                                                                                                                     Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
resolution nucleic acid structures (e.g. functional bind-         Pyle and co-worker (28) led to the use of a variant angle pair
ing sites) and the need to account correctly for this non-        (␩ and ␪  ) based on the P and C1 atoms. The C1 atom was
planarity in deriving models of DNA and RNA based on              chosen based on its more reliable location in X-ray crystal
low-resolution data. There, the bp non-planarity is quanti-       structures, due to its covalent linkage to the base. Following
fied by two angular parameters, Buckle and Propeller. In-         this line, we reason that the base ‘origin’, which is defined by
spired by her work, we developed a set of six ‘simple’ bp pa-     a least-squares fitting procedure using the whole rigid base
rameters (CCN, 2016, vol. 7, pp. 6–9), which are complete         plane, is even more reliably located.
and more intuitive for qualitative characterization of non-          Inspired by the finding of Richardson et al. (29) on the
WC pairs, and have already been used in the literature for        correlation between the sugar puckering and the perpen-
the characterization of G-tetrads in G-quadruplexes (26).         dicular distance between the bridging P atom and the pre-
We have subsequently extended the description to a new set        ceding C1 –N1/9 glycosidic bond, we extended the 3DNA
of six ‘simple’ step parameters.                                  double-helical parameter Zp (30) to a single-stranded ana-
   Figure 1B shows an example of the ‘simple’ bp and              log (ssZp). As shown in Figure 2B–D, ssZp is defined as the
step parameters for PDB entry 1xvk, a complex of DNA              z-coordinate of the bridging P atom expressed in the stan-
with echinomycin which contains two A+T Hoogsteen base            dard reference frame of the preceding base. This parameter
pairs (nos. 4 and 5). This echinomycin-(GCGTACGC)2                is sensitive to both sugar puckering (C2 -endo versus C3 -
complex has a single DNA strand as the asymmetric                 endo) and base conformation (syn versus anti): for a C2 -
unit. The biological unit is contained in a multi-model           endo sugar attached to an anti base as in B-form DNA,
MODEL/ENDMDL ensemble of two models, each corre-                  ssZp is a small, positive number; for a C3 -endo sugar at-
sponding to one chain of the duplex. Due to the perfect sym-      tached to an anti base as in A-form DNA and RNA, ssZp
metry and opposing directions of the bp reference frames,         is large and positive; for a base in a syn conformation as the
the central TA/TA step (no. 4, with two Hoogsteen pairs)          guanines in Z-form DNA and in certain G-quadruplexes,
has a local Rise of zero, and a Twist of 180 degrees, values      ssZp is negative. The potential advantage of ssZp over the
that do not make ‘intuitive’ sense (Figure 1B, base-block         perpendicular distance using C1 –N1/9 is similar to that for
image). On the other hand, the corresponding ‘simple’ pa-         the virtual angles mentioned above.
rameter description of step no. 4 has a Rise of 3.1 Å, and a
Twist of 26◦ , which are more intuitively reasonable.
                                                                  The ‘Visualization’ module
   Overall, bp geometry can be described in more than one
way. The existing set of six local bp and step parameters         The visualization module can be used to examine a sin-
in 3DNA is mathematically rigorous, allowing for an un-           gle structure or a multi-model ensemble, such as a se-
ambiguous characterization of any pair of interacting bases       ries of NMR-derived or computer-simulated structures, in
and serving as input for exact model building. The new sets       schematic base-block representations, with backbone rib-
of six ‘simple’ bp and six ‘simple’ step parameters provide       bons and protein cartoons (Figure 1C). If the entry contains
a more intuitive interpretation of structural variations in       a single structure, block images are automatically created to
non-WC-containing structures. The term ‘simple’ is used to        show the model from five perpendicular perspectives. Each
distinguish the new set of parameters from the traditional        image has a corresponding downloadable link and is en-
3DNA local parameters. It should be emphasized that the           larged with mouse hovering. If the entry corresponds to an
‘simple’ parameters are for structural description only, and      ensemble of structures, users can specify the range of mod-
are not suitable as input for the 3DNA ‘rebuild’ program.         els for display and choose a bp for local alignment. Figure
The two types of parameters complement one another and            1C shows an ensemble of 10 solution NMR structures of
serve different audiences and/or purposes. Numerical val-         a protein–DNA complex from PDB entry 2moe (31). Here
ues of both are readily obtained with 3DNA. See Supple-           the structures are aligned on the fifth bp, containing one
mental Data S1 for details.                                       of the two methyl-cytosines recognized on its major-groove
                                                                  edge by the protein. The exposed and unrecognized minor-
New parameters connecting base and backbone atoms. In             groove edge of the aligned base pairs is at once apparent
w3DNA 2.0, we have also introduced two new structural             from the shading automatically introduced by the software.
parameters that integrate the rigid base plane and the back-         The rectangular base-block representation is simple and
bone phosphate group, the two nucleic acid components             informative (Figures 1–3). With color-coding, the base iden-
most reliably determined with X-ray crystallography. These        tity, pairing geometry, and stacking interactions are imme-
W32 Nucleic Acids Research, 2019, Vol. 47, Web Server issue


diately obvious in small to mid-sized nucleic acid struc-         ploys a standard RNA helical backbone (with C3 -endo
tures. It is worth noting that this schematic representation      sugar puckering) attached to each base. The resultant back-
has been adopted by both the PDB and the NDB, and                 bone, however, is oftentimes distorted, without proper cova-
propagated into other online bioinformatics resources. In         lent linkages between neighboring nucleotides. Users have
w3DNA 2.0, we have significantly increased the resolution         the option to optimize this approximate backbone connec-
of these block images, which look much crisper and are of         tion, using Phenix (23), while keeping the base atoms fixed.
publication quality.                                              The 3DNA-Phenix combination leads to a model where
  Stacking diagrams (5) of all the bp steps in a double-          the base geometry strictly follows the parameters prescribed
helical structure can also be generated (not shown, see Sup-      in the user-specified file, and the backbone is regularized
plementary Data S4.2). The view is taken down the z-axis          with improved stereochemistry and a ‘smooth’ appearance
of the middle frame used in calculating step parameters. As       in ribbon representation.
for base-block images, we have increased the resolution of           Building a mixed, naturally curved DNA structure with




                                                                                                                                  Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
the images for stacking diagrams in the updated server and        A-, B- and C-form components is also available in this sec-
provided options for the labeling of nucleotides.                 tion. After choosing the number of segments from a pull-
                                                                  down menu, users can type in the base sequence, an optional
                                                                  repeating number, and choose the helical form(s) of DNA.
The modeling modules
The w3DNA 2.0 server contains four modeling modules               Composite. To construct a protein-decorated DNA
that enable users to create new 3D nucleic acid structures or     model, users need to specify the number of protein-binding
perform base mutations of existing ones. The structures are       sites, the base sequence, and the helical form (B- or A-
generated by a combination of ad hoc scripts and 3DNA             type DNA). For each binding site, users then assign a
modeling routines with user-specified bp parameters and           binding position along the DNA model and a protein–
templates. The choices include five model-building types: (i)     DNA complex template (via a PDB id). The binding
customized single-stranded RNA or double-helical DNA              position corresponds to the middle of the DNA in the
structures with user-specific base sequences and rigid-           protein–DNA complex. Different binding sites can use
body parameters (Supplemental Data S2); (ii) mixed DNA            the templates of different protein–DNA complexes. The
double-helical structures comprised of canonical A-, B-,          server performs checks to avoid the overlap of neighboring
and C-type DNA fragments; (iii) protein-decorated DNA             binding positions.
structures with user-defined binding sites and templates             From a starting B- or A-form DNA model, the (differ-
of known DNA-protein complexes; (iv) 56 uniform fiber-            ent) binding proteins may distort the straight double he-
diffraction models (9), containing single-stranded RNA,           lix into a complicated 3D shape, depending on the config-
different helical forms of DNA, hybrid DNA/RNA helices,           uration of the DNA template in each protein–DNA com-
triplexes (32), and quadruplexes; (v) models with bases mu-       plex. This ‘composite’ modeling is an advanced topic and
tated at user-specified locations while preserving backbone       involves many components of the 3DNA suite and some
geometry.                                                         ad hoc scripts. Figure 1E shows such a ‘composite’ model
   All resulting 3D models share the same output interface:       of DNA ‘decorated’ with proteins. Here the X-ray crystal
(i) a schematic base-block representation in the principal-       structure of a nucleosome from PDB entry 4xzq (34) is used
axis frame; (ii) a coordinate file in PDB format, which can       as a template to construct a three-nucleosome, chromatin-
be downloaded for further study and (iii) a JSmol window          like model. Specifically, the nucleosomal DNA in 4xzq has
for interactive visualization.                                    146 bp. Approximated to 150 bp, the middle position is at
                                                                  75. Leaving 10 bp at both ends, and two linkers of 25 bp
Rebuilding. To build a customized DNA/RNA model, the              each in the middle, we need a DNA of 520 bp (2 × 10 + 3 ×
user is required to prepare a text file containing the base se-   150 + 2 × 25) to wrap around three nucleosomes. The three
quence and rigid-body parameters of the desired structure.        protein-binding sites are thus centered at base positions 85,
Two example parameter files (Supplemental Data S2) can            260, and 435 of the 520-bp DNA, i.e., 175-bp dyad spacing
be found on the customized modeling section, where click-         between successive nucleosomes. The model presented here
ing a sample-file link auto-fills the corresponding content       assigns a B-form fiber model to the four protein-free DNA
in the text area. Users can also upload a parameter file in       regions (two linkers plus both ends), each with a poly dA
valid format. In practice, the input file is most conveniently    sequence in the leading strand.
generated by running the ‘Analysis’ module on a starting
structure, and then modifying the resultant parameter file        Fiber. We have extended the regular DNA/RNA helical
as needed. After selecting the desired backbone conforma-         models (5) that can be constructed, most based on early
tion and choosing whether to perform backbone geometry            fiber diffraction studies of Arnott and co-workers (9), to a
optimization, users can click the ‘Build Model’ button to         total of 56. New additions include a single-stranded RNA
trigger the modeling pipeline.                                    model of generic sequence (A, C, G and U), derived from
   Figure 1D shows a tRNA model built from the local bp           the A-form DNA fiber model (9) and the historic Pauling
and step parameters (Supplemental Data S2) obtained from          triplex model (32), an unusual structure with exposed bases
an analysis of PDB entry 1fir (33), the crystal structure of      consistent with the response of DNA to extreme stretching
HIV reverse-transcription primer tRNA(Lys,3). Here, the           and over-winding (35).
15 modified bases have been replaced by their standard               Based on user feedback, we have optimized the interface
counterparts. The initial model rebuilt using 3DNA em-            for constructing fiber models (Figure 3A). The six most
                                                                   Nucleic Acids Research, 2019, Vol. 47, Web Server issue W33


commonly used models are highlighted at the top of this              who helped improve and clarify this manuscript and the
section. Now users can easily build regular models of single-        website.
stranded RNA, double-helical A-, B- or C-DNA, and the
Pauling triplex, with user-specified base sequences. On the
other hand, the polyI:polyI:polyI:polyI quadruplex is spe-           FUNDING
cific to hypoxanthine. Figure 3B–E were generated with de-           National Institutes of Health (NIH) [R01GM096889 to
fault settings, each taking just two-button clicks (first select     X.J.L., R01GM034809 to W.K.O.]. Funding for open ac-
a model, and then press the ‘Build’ button) and a few sec-           cess charge: NIH [R01GM096889].
onds waiting time.                                                   Conflict of interest statement. None declared.
Mutation. A new functionality of w3DNA 2.0 is the in sil-
ico base mutations of nucleic acid structures, by calling the        REFERENCES




                                                                                                                                                    Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
command-line program ‘mutate bases’. Notably, the mu-
                                                                      1. Burley,S.K., Berman,H.M., Christie,C., Duarte,J.M., Feng,Z.,
tation process preserves both the geometry of the sugar-                 Westbrook,J., Young,J. and Zardecki,C. (2018) RCSB Protein Data
phosphate backbone and the base reference frame (posi-                   Bank: Sustaining a living digital data resource that enables
tion and orientation). As a result, re-analyzing the mutated             breakthroughs in scientific research and biomedical education.
model gives the same bp and step parameters as those of the              Protein Sci., 27, 316–330.
original structure. The 3DNA ‘mutate bases’ program has               2. Berman,H.M., Olson,W.K., Beveridge,D.L., Westbrook,J., Gelbin,A.,
                                                                         Demeny,T., Hsieh,S.H., Srinivasan,A.R. and Schneider,B. (1992) The
already been employed in the literature for inference of sta-            nucleic acid database. A comprehensive relational database of
tistical protein–DNA potentials (36) and homology model-                 three-dimensional structures of nucleic acids. Biophys. J., 63, 751–759.
ing of the Escherichia coli FMN aptamer (37).                         3. Colasanti,A.V., Lu,X.J. and Olson,W.K. (2013) Analyzing and
   The starting structure for mutations can be specified by              building nucleic acid structures with 3DNA. J. Vis. Exp., 74, e4401.
                                                                      4. Lu,X.J. and Olson,W.K. (2008) 3DNA: a versatile, integrated
a PDB id or uploaded from a coordinate file. Alternatively,              software system for the analysis, rebuilding and visualization of
models constructed by other w3DNA 2.0 modeling mod-                      three-dimensional nucleic-acid structures. Nat. Protoc., 3, 1213–1227.
ules mentioned above can be directly used for base muta-              5. Lu,X.J. and Olson,W.K. (2003) 3DNA: a software package for the
tions. Figure 3F shows an example of the mutation of all the             analysis, rebuilding and visualization of three-dimensional nucleic
hypoxanthines of the polyI:polyI:polyI:polyI quadruplex                  acid structures. Nucleic Acids Res., 31, 5108–5121.
                                                                      6. Lavery,R., Moakher,M., Maddocks,J.H., Petkeviciute,D. and
(Figure 3E) to guanine, leading to a parallel G-quadruplex.              Zakrzewska,K. (2009) Conformational analysis of nucleic acids
                                                                         revisited: Curves+. Nucleic Acids Res., 37, 5917–5929.
                                                                      7. Olson,W.K., Bansal,M., Burley,S.K., Dickerson,R.E., Gerstein,M.,
CONCLUSION                                                               Harvey,S.C., Heinemann,U., Lu,X.J., Neidle,S., Shakked,Z. et al.
                                                                         (2001) A standard reference frame for the description of nucleic acid
The new w3DNA 2.0 web server provides a modern interac-                  base-pair geometry. J. Mol. Biol., 313, 229–237.
tive user interface for the analysis, visualization, and model-       8. Dickerson,R.E., Bansal,M., Calladine,C.R., Diekmann,S.,
ing of 3D nucleic acid structures, including their complexes             Hunter,W.N., Kennard,O., von Kitzing,E., Lavery,R.,
with proteins and other ligands. The server embeds popu-                 Nelson,H.C.M., Olson,W.K. et al. (1989) Definitions and
lar and new features of the 3DNA suite of command-line                   nomenclature of nucleic acid structure parameters. EMBO J., 8, 1–4.
                                                                      9. Arnott,S. (1999) In: Neidle,S (ed). Oxford Handbook of Nucleic Acid
programs via a simple and intuitive web interface, with a                Structure. Oxford University Press, Oxford, pp. 1–38.
built-in set of sensible defaults. As a result, even novice or       10. Macke,T. and Case,D.A. (1998) In: Leontis,NB and SantaLucia,J
occasional users can quickly get started and benefit from                (eds). Molecular Modeling of Nucleic Acids. American Chemical
the many features that 3DNA has to offer. Specifically,                  Society, Washington, DC, pp. 379–393.
                                                                     11. Bansal,M., Bhattacharyya,D. and Ravi,B. (1995) NUPARM and
w3DNA 2.0 allows users: (i) to gather information and gain               NUCGEN: software for analysis and generation of sequence
insight about DNA/RNA conformational features, via the                   dependent nucleic acid structures. Comput. Appl. Biosci., 11, 281–287.
‘Analysis’ module; (ii) to create high-resolution base-block         12. Bhattacharyya,D., Halder,S., Basu,S., Mukherjee,D., Kumar,P. and
schematic images that are both simple and highly reveal-                 Bansal,M. (2017) RNAHelix: computational modeling of nucleic acid
ing, via the ‘Visualization’ module and (iii) to construct 3D            structures with Watson–Crick and non-canonical base pairs. J.
                                                                         Comput. Aided Mol. Des., 31, 219–235.
models that can be used in various computational applica-            13. Lu,X.J. and Olson,W.K. (1999) Resolving the discrepancies among
tions, such as atomic-level simulations of DNA/RNA struc-                nucleic acid conformational analyses. J. Mol. Biol., 285, 1563–1575.
tures or their complexes with proteins, via the ‘Modeling’           14. Zheng,G., Lu,X.J. and Olson,W.K. (2009) Web 3DNA––a web server
modules. Furthermore, user questions are always welcome                  for the analysis, reconstruction, and visualization of
                                                                         three-dimensional nucleic-acid structures. Nucleic Acids Res., 37,
and promptly addressed on the 3DNA Forum.                                W240–W246.
                                                                     15. Blanchet,C., Pasi,M., Zakrzewska,K. and Lavery,R. (2011)
                                                                         CURVES+ web server for analyzing and visualizing the helical,
SUPPLEMENTARY DATA                                                       backbone and groove parameters of nucleic acid structures. Nucleic
Supplementary Data are available at NAR Online.                          Acids Res., 39, W68–W73.
                                                                     16. van Dijk,M. and Bonvin,A.M. (2009) 3D-DART: a DNA structure
                                                                         modelling server. Nucleic Acids Res., 37, W235–W239.
                                                                     17. Dienemann,C., Schwalb,B., Schilbach,S. and Cramer,P. (2019)
ACKNOWLEDGEMENTS                                                         Promoter Distortion and Opening in the RNA Polymerase II Cleft.
We would like to thank the user community for using                      Mol. Cell, 73, 97–106.
                                                                     18. Tamulaitiene,G., Manakova,E., Jovaisaite,V., Tamulaitis,G.,
w3DNA and providing us with feedback, and Yin Yin Lu                     Grazulis,S., Bochtler,M. and Siksnys,V. (2019) Unique mechanism of
for proofreading the manuscript. We appreciate the com-                  target recognition by PfoI restriction endonuclease of the
ments and suggestions of the three anonymous reviewers                   CCGG-family. Nucleic Acids Res., 47, 997–1010.
W34 Nucleic Acids Research, 2019, Vol. 47, Web Server issue


19. Xu,Y., Gissberg,O., Pabon-Martinez,Y.V., Wengel,J., Lundin,K.E.,                Richardson,D.C. (2010) MolProbity: all-atom structure validation for
    Smith,C.I.E., Zain,R., Nilsson,L. and Villa,A. (2019) The ability of            macromolecular crystallography. Acta Crystallogr. D. Biol.
    locked nucleic acid oligonucleotides to pre-structure the double helix:         Crystallogr., 66, 12–21.
    A molecular simulation and binding study. PLoS One, 14, e0211651.         30.   Lu,X.J., Shakked,Z. and Olson,W.K. (2000) A-form conformational
20. Luo,G.Z., Hao,Z., Luo,L., Shen,M., Sparvoli,D., Zheng,Y.,                       motifs in ligand-bound DNA structures. J. Mol. Biol., 300, 819–840.
    Zhang,Z., Weng,X., Chen,K., Cui,Q. et al. (2018)                          31.   Walavalkar,N.M., Cramer,J.M., Buchwald,W.A., Scarsdale,J.N. and
    N(6)-methyldeoxyadenosine directs nucleosome positioning in                     Williams,D.C. Jr2014) Solution structure and intramolecular
    Tetrahymena DNA. Genome Biol., 19, 200.                                         exchange of methyl-cytosine binding domain protein 4 (MBD4) on
21. Lu,X.J., Bussemaker,H.J. and Olson,W.K. (2015) DSSR: an                         DNA suggests a mechanism to scan for mCpG/TpG mismatches.
    integrated software tool for dissecting the spatial structure of RNA.           Nucleic Acids Res., 42, 11218–11232.
    Nucleic Acids Res., 43, e142.                                             32.   Pauling,L. and Corey,R.B. (1953) A proposed structure for the
22. Hanson,R.M., Prilusky,J., Renjian,Z., Nakane,T. and Sussman,J.L.                nucleic acids. Proc. Natl. Acad. Sci. U.S.A., 39, 84–97.
    (2013) JSmol and the next-generation web-based representation of          33.   Benas,P., Bec,G., Keith,G., Marquet,R., Ehresmann,C.,
    3D molecular structure as applied to Proteopedia. Israel J. Chem., 53,          Ehresmann,B. and Dumas,P. (2000) The crystal structure of HIV
    207–216.                                                                        reverse-transcription primer tRNA(Lys,3) shows a canonical




                                                                                                                                                             Downloaded from https://academic.oup.com/nar/article-abstract/47/W1/W26/5494724 by guest on 18 June 2020
23. Adams,P.D., Afonine,P.V., Bunkoczi,G., Chen,V.B., Davis,I.W.,                   anticodon loop. RNA, 6, 1347–1355.
    Echols,N., Headd,J.J., Hung,L.W., Kapral,G.J.,                            34.   Chatterjee,N., North,J.A., Dechassa,M.L., Manohar,M., Prasad,R.,
    Grosse-Kunstleve,R.W. et al. (2010) Phenix: a comprehensive                     Luger,K., Ottesen,J.J., Poirier,M.G. and Bartholomew,B. (2015)
    Python-based system for macromolecular structure solution. Acta                 Histone Acetylation near the Nucleosome Dyad Axis Enhances
    Crystallogr. D. Biol. Crystallogr., 66, 213–221.                                Nucleosome Disassembly by RSC and SWI/SNF. Mol. Cell. Biol.,
24. Kraulis,P.J. (1991) MolScript: a program to produce both detailed               35, 4083–4092.
    and schematic plots of protein structures. J. Appl.                       35.   Allemand,J.F., Bensimon,D., Lavery,R. and Croquette,V. (1998)
    Crystallogr., 24, 946–950.                                                      Stretched and overwound DNA forms a Pauling-like structure with
25. Merritt,E.A. and Bacon,D.J. (1997) Raster3D: photorealistic                     exposed bases. Proc. Natl. Acad. Sci. U.S.A., 95, 14152–14157.
    molecular graphics. Methods Enzymol., 277, 505–524.                       36.   AlQuraishi,M. and McAdams,H.H. (2013) Three enhancements to
26. Meier,M., Moya-Torres,A., Krahn,N.J., McDougall,M.D.,                           the inference of statistical protein–DNA potentials. Proteins, 81,
    Orriss,G.L., McRae,E.K.S., Booy,E.P., McEleney,K., Patel,T.R.,                  426–442.
    McKenna,S.A. et al. (2018) Structure and hydrodynamics of a DNA           37.   Howe,J.A., Wang,H., Fischmann,T.O., Balibar,C.J., Xiao,L.,
    G-quadruplex with a cytosine bulge. Nucleic Acids Res., 46,                     Galgoci,A.M., Malinverni,J.C., Mayhood,T., Villafania,A., Nahvi,A.
    5319–5331.                                                                      et al. (2015) Selective small-molecule inhibition of an RNA structural
27. Olson,W.K. (1980) Configurational statistics of polynucleotide                  element. Nature, 526, 672–677.
    chains. An updated virtual bond model to treat effects of base            38.   Cuesta-Seijo,J.A. and Sheldrick,G.M. (2005) Structures of complexes
    stacking. Macromolecules, 13, 721–728.                                          between echinomycin and duplex DNA. Acta Crystallogr. D. Biol.
28. Keating,K.S., Humphris,E.L. and Pyle,A.M. (2011) A new way to see               Crystallogr., 61, 442–448.
    RNA. Q. Rev. Biophys., 44, 433–466.
29. Chen,V.B., Arendall,W.B. 3rd, Headd,J.J., Keedy,D.A.,
    Immormino,R.M., Kapral,G.J., Murray,L.W., Richardson,J.S. and
