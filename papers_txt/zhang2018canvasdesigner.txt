                                                                                                        Bioinformatics, 34(19), 2018, 3419–3420
                                                                                                              doi: 10.1093/bioinformatics/bty377
                                                                                               Advance Access Publication Date: 3 May 2018
                                                                                                                         Applications Note




                                                                                                                                                                     Downloaded from https://academic.oup.com/bioinformatics/article-abstract/34/19/3419/4992145 by Univ Massachusetts Healey Library user on 29 May 2020
Systems biology

canvasDesigner: a versatile interactive
high-resolution scientific multi-panel
visualization toolkit
Baohong Zhang1,*, Shanrong Zhao1 and Isaac Neuhaus2,*
1
 Early Clinical Development, Pfizer Inc., Cambridge, MA 02139, USA and 2Computational Genomics, Bristol-Myers
Squibb Company, Pennington, NJ 08534, USA
*To whom correspondence should be addressed.
Associate Editor: Oliver Stegle
Received on October 6, 2017; revised on April 20, 2018; editorial decision on April 27, 2018; accepted on May 2, 2018


Abstract
Summary: We present a bioinformatics and systems biology visualization toolkit harmonizing real
time interactive exploring and analyzing of big data, full-fledged customizing of look-n-feel and pro-
ducing multi-panel publication-ready figures in PDF format simultaneously.
Availability and implementation: Source code and detailed user guides are available at http://can
vasxpress.org, https://baohongz.github.io/canvasDesigner and https://baohongz.github.io/canvas
Designer/demo_video.html.
Contact: isaac.neuhaus@bms.com or baohong.zhang@pfizer.com
Supplementary information: Supplementary data are available at Bioinformatics online.



1 Introduction                                                                            modifying a graph. The file can then be opened in a webpage con-
                                                                                          taining a canvasXpress panel to reproduce the exact plot. Please see
CanvasXpress was initially developed as the core visualization com-
                                                                                          a step-by-step example at https://goo.gl/xoErzW.
ponent for bioinformatics and systems biology analysis at Bristol-
                                                                                              Like those high-end commercial tools, CanvasXpress also includes
Myers Squibb. It was further enhanced by scientists around the
                                                                                          a standalone unobtrusive data table and a filtering widget to allow
world and served as a key visualization engine for many popular
                                                                                          data exploration and filtering. Data can be dynamically sorted, segre-
bioinformatics tools and analyses (Ankenbrand, et al., 2016;
                                                                                          gated, transposed, transformed, clustered and grouped by multiple
Davenport, et al., 2017; Dower, et al., 2017; TrinotateWeb, https://
                                                                                          levels. The mouse events as well as the zooming, panning and drag-n-
goo.gl/8BpVZ4; Zhao, et al., 2016; Zhao, et al., 2017). It offers a
                                                                                          drop capabilities are fully customizable features that make this library
rich set of interactive plots to display scientific and genomics data,
                                                                                          capable of further expansion of functionalities.
such as oncoprint of cancer mutations, heatmap, 3D scatter, violin,
pathway, treemap, volcano and many other types of plots.
    Recently, the reproducibility and usability of the package in real
world bioinformatics and clinical use cases have been improved sig-                       2 Materials and methods
nificantly, which is witnessed by continuous add-on features and                          CanvasXpress is a standalone JavaScript library that works in all
wide adoption of the toolkit in the scientific communities.                               modern browsers on mobile, tablets and desktop devices. The fol-
Emphasizing reproducibility, canvasXpress captures all program-                           lowing example shows its basic usage. The JavaScript, the styling
matic and user interactions, which includes modifications done                            CSS and input data are described in the <head> section.
through the menus, on plot controls and the comprehensive configu-                        A <canvas> element is embedded into the <body> section. When
rator as illustrated at https://goo.gl/q3mFxe. The customization is                       the web page, https://goo.gl/1tAhta is loaded, the callback function
recorded and saved into a JSON file in real time as the user is                           initPage will trigger the plotting.




C The Author(s) 2018. Published by Oxford University Press. All rights reserved. For permissions, please e-mail: journals.permissions@oup.com
V                                                                                                                                                           3419
3420                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  B.Zhang et al.


   A                                                                                                                                                                                                                                                                             B                                                                                                                    C


                     10

                          5

                                  0




                                                                                                                                                                                                                                                                      6
                                                                                                                                                                                                                                                                      7
                                                                                                                                                                                                                                                                      8
                                                                                                                                                                                                                                                                      9
                                                                                                                                                                                                                                                                                                                                                      150
                                                                                                                                                                                                                                                                                                                                                      100
                                                                                                                                                                                                                                                                                                                                                       50
         Variable1                                                                                                                                                                                                                                                                                                                                      0
                                                                                                                                                                                                                                                                                                                                                            -8   0   8


                                                                                                                                                                                                                                                                                                                                                                                                       2.25

                                                                                                                                                                                                                                                                                                                                                                                                                       2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Species
         Variable2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  setosa




                                                                                                                                                                                                                                                                                                                                      Ph



                                                                                                                                                                                                                                                                                                                                      Ph




                                                                                                                                                                                                                                                                                                                                                     Ph




                                                                                                                                                                                                                                                                                                                                                                 Ph




                                                                                                                                                                                                                                                                                                                                                                 Ph

                                                                                                                                                                                                                                                                                                                                                                 Ph




                                                                                                                                                                                                                                                                                                                                                                                          Ph

                                                                                                                                                                                                                                                                                                                                                                                          Ph
                                                                                                                                                                                                                                                                                                                                      Ty

                                                                                                                                                                                                                                                                                                                                      Ty


                                                                                                                                                                                                                                                                                                                                      Ty



                                                                                                                                                                                                                                                                                                                                      Ot



                                                                                                                                                                                                                                                                                                                                                     Ty




                                                                                                                                                                                                                                                                                                                                                                 Ty

                                                                                                                                                                                                                                                                                                                                                                 Ot

                                                                                                                                                                                                                                                                                                                                                                 Ot




                                                                                                                                                                                                                                                                                                                                                                 Ot

                                                                                                                                                                                                                                                                                                                                                                 Ty




                                                                                                                                                                                                                                                                                                                                                                                          Ty

                                                                                                                                                                                                                                                                                                                                                                                          Ty
                                                                                                                                                                                                                                                                                                                                      Pr


                                                                                                                                                                                                                                                                                                                                      Pr



                                                                                                                                                                                                                                                                                                                                      Pr




                                                                                                                                                                                                                                                                                                                                                                 Pr
                                                                                                                                                                                                                                                                                                                                      Ki




                                                                                                                                                                                                                                                                                                                                                     Ki




                                                                                                                                                                                                                                                                                                                                                                 Ki

                                                                                                                                                                                                                                                                                                                                                                 Ki


                                                                                                                                                                                                                                                                                                                                                                 Ki



                                                                                                                                                                                                                                                                                                                                                                 Ki



                                                                                                                                                                                                                                                                                                                                                                               Ki




                                                                                                                                                                                                                                                                                                                                                                                          Ki
                                                                                                                                                                                                                                                                                                                                               Pro        Oth            Pro        Oth        Type               1.75
                                                                                                                                                                                                                                                                                                                         4                                                                                                                                                                                                                                          versicolor
                                                                                                                                                                                                                                                                                                                         3                                                                     Sens                                                                                                                                                                 virginica




                                                                                                                                                                                                                                                                                                30
                                                                                                                                                                                                                                                                                                20
                                                                                                                                                                                                                                                                                                10
                                                                                                                                                                                                                                                                                                                         2                                                                                                 1.5




                                                                                                                                                                                                                                                                                                0
                                                                                                                                                                                                                                                                                                                         1




                                                                                                                                                                                                                                                                                                                                                                                                      h
                                                                                                                                                                                                                                                                                                                                                                                                      i dt
                                                                                                                                                                                                                                                                                                                                                                                                                               1.25




                                                                                                                                                                                                                                                                                                                    Sit Sit Sit Sit
                                                                                                                                                                                                                                                                                     Sample11




                                                                                                                                                                                                                                                                                                                                                                                                          .W
                                                                                                                                                                                                                                                                                                                                                                                                          t al
                                                                                                                                                                                                                                                                                                                                                                                                                                      1
                                                                                                                                                                                                                                                                                     Sample19




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Downloaded from https://academic.oup.com/bioinformatics/article-abstract/34/19/3419/4992145 by Univ Massachusetts Healey Library user on 29 May 2020
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          7.5
                                                                                                                                                                                                                                                                                                                                                                                                                Pe
         Variable3




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   6.75
                                                                                                                                                                                                                                                                                                                                                                                                                                  0.75
                                                                                                                                                                                                                                                                                     Sample9




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      5.25
                                                                                                                                                                                                                                                                                                                                                                                                                                          0.5
                                                                                                                                                                                                                                                                                     Sample25




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                4.5
                                                                                                                                                                                                                                                                                                       TreatmentB
                                                                                                                                                                                                                                                                                                                                                                                                                                          0.25




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         3.75
                       Altered
                       Deleted
                      Amplified


                                      Sample1

                                                  Sample2

                                                             Sample3

                                                                         Sample4

                                                                                   Sample14

                                                                                              Sample19

                                                                                                            Sample7

                                                                                                                        Sample9

                                                                                                                                  Sample8

                                                                                                                                            Sample20

                                                                                                                                                       Sample13

                                                                                                                                                                   Sample17

                                                                                                                                                                               Sample11

                                                                                                                                                                                          Sample10

                                                                                                                                                                                                     Sample15

                                                                                                                                                                                                                Sample16

                                                                                                                                                                                                                            Sample12

                                                                                                                                                                                                                                       Sample6

                                                                                                                                                                                                                                                 Sample5

                                                                                                                                                                                                                                                           Sample18

                                                                                                                                                                                                                                                                      Mutated
                                                                                                                                                                                                                                                                                     Sample13




                                                                                                                                                                                                                                                                                                                    Site2




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              th
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ng
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Le




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2.25
                                                                                                                                                                                                                                                                                                                                                                                                                                                 4.5
                                                                                                                                                                                                                                                                                                                                                                                                                                                       5
                                                                                                                                                                                                                                                                                     Sample7                                                                                                                                                                                                                                                         l.




                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6.5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ta




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1.5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              7
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Pe




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  7.5

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        8

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             8.5
                                                                                                                                                                                                                                                                                                                    Sit Sit
                                                                                                                                                                                                                                                                                     Sample17
                                                                                                                                                                                                                                                                                     Sample15                                                                                                                                                              Sepal.L
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ength
                                                Amplification                        Deletion                           Mutation
                                                                                                                                                                                                                                                                                     Sample21




                                                                                                                                                                                                                                                                                                                    Site3
   D                                                                                                                                        E                                                                                                                                        Sample23
                                                                                                                                                                                                                                                                                                                                                                                                      F




                                                                                                                                                                                                                                                                                                                    Sit
                                                                                                                                                                                                                                                                                     Sample8
     8                                                                                                                                                                                                                                                                Activate
                                                                                                                                                                                                                                                                                                                                                                                                                           2
                                                                                                                                                                  Gene                                                                                                               Sample24




                                                                                                                                                                                                                                                                                                                    Site3
                                                                                                                                                                                                                                                                                     Sample16
                                                                                                                                                                               exp1
                                                                                                                                                                                                                                                                                     Sample12




                                                                                                                                                                                                                                                                                                       TreatmentA
                                                                                                                                                                               exp2
                                                                                                                                                                               exp3                                        Gene5                                                     Sample10
                                                                                                                                                                                                                                                                                                                                                                                                                           1




                                                                                                                                                                                                                                                                                                                    Site2
     6
                                                                                                                                                                                                                                                                                     Sample14
                                                                                                                                                       Gene7                              Gene1
                                                                                                                                                                                                                                                                                     Sample6
                                                                                                                                                                                                                                                           Gene3                     Sample20                                                                                                                              0
                                                                                                         Sepal.Length




                                                                                                                                                                                                                                                                                                                    Site3
     4
                                                                                                         Sepal.Width                                                                                                                                                                 Sample18




                                                                                                                                                                                                                                                                                                                                                                                                               logFC
                                                                                                         Petal.Length
                                                                                                         Petal.Width                                                                                                                                                                 Sample22
                                                                                                                                                                                                                                                                                     Sample3
                                                                                                                                                                                                                                                 Receptor Gene4                                                                                                                                                        -1

                                                                                                                                                                                                                                                                                     Sample5




                                                                                                                                                                                                                                                                                                       Control
                                                                                                                                                                                                                                                                                                                    Site1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Group
     2                                                                                                                                                                                                                                                                               Sample1                                                                                                                                                                                                                                                                Decreased
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Increased
                                                                                                                                                                                                                                                                                     Sample2                                                                                                                                                                                                                                                                NoChange
                     Species with                                                                                                                                             Gene2                                                                                                  Sample4
                                                                                                                                                                                                                                                                                                                                                                                                                       -2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          FC
                     lowest petal
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0




                                                                                                                                                                                                                                                                                                Dose

                                                                                                                                                                                                                                                                                                       Treatment
                                                                                                                                                                                                                                                                                                                    Site

                                                                                                                                                                                                                                                                                                                                      Probe22
                                                                                                                                                                                                                                                                                                                                      Probe31
                                                                                                                                                                                                                                                                                                                                      Probe37
                                                                                                                                                                                                                                                                                                                                      Probe38
                                                                                                                                                                                                                                                                                                                                      Probe36
                                                                                                                                                                                                                                                                                                                                      Probe27
                                                                                                                                                                                                                                                                                                                                      Probe34
                                                                                                                                                                                                                                                                                                                                      Probe18
                                                                                                                                                                                                                                                                                                                                      Probe16
                                                                                                                                                                                                                                                                                                                                      Probe30
                                                                                                                                                                                                                                                                                                                                      Probe21
                                                                                                                                                                                                                                                                                                                                      Probe26
                                                                                                                                                                                                                                                                                                                                      Probe33
                                                                                                                                                                                                                                                                                                                                      Probe32
                                                                                                                                                                                                                                                                                                                                      Probe19
                                                                                                                                                                                                                                                                                                                                      Probe40
                                                                                                                                                                                                                                                                                                                                      Probe20
                                                                                                                                                                                                                                                                                                                                      Probe28
                                                                                                                                                                                                                                                                                                                                      Probe17
                                                                                                                                                                                                                                                                                                                                      Probe24
                                                                                                                                                                                                                                                                                                                                      Probe25
                                                                                                                                                                                                                                                                                                                                      Probe29
                                                                                                                                                                                                                                                                                                                                      Probe35
                                                                                                                                                                                                                                                                                                                                      Probe23
                                                                                                                                                                                                                                                                                                                                      Probe39
                                                                                                                                                                                                                                                                                                                                       Probe3
                                                                                                                                                                                                                                                                                                                                      Probe11
                                                                                                                                                                                                                                                                                                                                       Probe5
                                                                                                                                                                                                                                                                                                                                       Probe9
                                                                                                                                                                                                                                                                                                                                       Probe2
                                                                                                                                                                                                                                                                                                                                       Probe6
                                                                                                                                                                                                                                                                                                                                       Probe1
                                                                                                                                                                                                                                                                                                                                       Probe4
                                                                                                                                                                                                                                                                                                                                      Probe10
                                                                                                                                                                                                                                                                                                                                      Probe15
                                                                                                                                                                                                                                                                                                                                       Probe8
                                                                                                                                                                                                                                                                                                                                      Probe12
                                                                                                                                                                                                                                                                                                                                      Probe13
                                                                                                                                                                                                                                                                                                                                       Probe7
                                                                                                                                                                                                                                                                                                                                      Probe14
                        width                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1

     0   setosa                   versicolor                           virginica
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                3
                                                                                                                                                                                                                                                                                                                                                                                                                       -3
                                  Species                                                                                                                                                            Cool Pathway                                                                                                                                                                                                                -1                    -0.5                        0                        0.5                              1                          1.5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AveExpr




Fig. 1. Versatile plots generated by canvasXpress and arranged by canvasDesigner. (A) Oncoprint of cancer mutations; (B) Gene expression heatmap with com-
prehensive annotations; (C) 3D scatter plot; (D) Violin plot; (E) Pathway with gene expression bar plots; (F) Profile plot of gene expression


<html>                                                                                                                                                                                                                                                                                                                                canvasXpress and other tools as illustrated in Supplementary pages
  <head>                                                                                                                                                                                                                                                                                                                              3 and 5. Each individual plot could be freely positioned and adjusted
 <link rel¼“stylesheet”                                                                                                                                                                                                                                                                                                               in size by controls added to each plot. At last, printing as PDF can
href¼“https://canvasxpress.org/css/canvasXpress.css” type¼“text/                                                                                                                                                                                                                                                                      generate a high-resolution multi-panel plot as shown in Figure 1,
 css”/>                                                                                                                                                                                                                                                                                                                               which is a standard option on all modern Internet browsers. In add-
    <script type¼“text/javascript”                                                                                                                                                                                                                                                                                                    ition, the composed plot could be saved as HTML to be embedded
src¼“https://canvasxpress.org/js/canvasXpress.min.js”></script>                                                                                                                                                                                                                                                                       into web based reports for sharing. This design tool relieves scien-
       <script>                                                                                                                                                                                                                                                                                                                       tists from hours if not days of struggle of using multiple tools, some-
         var initPage ¼ function () {                                                                                                                                                                                                                                                                                                 time even programming in R or other scripting languages in order to
         var data ¼ {“y”: {“vars”: [“Gene1”],                                                                                                                                                                                                                                                                                         get job done.
                                                             “smps”: [“Smp1”, “Smp2”, “Smp3”],
                                                             “data”: [[10, 35, 88]]
                                                            } };
                                                                                                                                                                                                                                                                                                                                      3 Summary
         var conf ¼ {“graphType”: “Bar”};
         var cX ¼ new CanvasXpress(“canvasId”, data, conf);
                                                                                                                                                                                                                                                                                                                                      CanvasDesigner toolkit is the first open source package with unpre-
                                                                                                                                                                                                                                                                                                                                      cedented interactive functionalities that are even not seen in expen-
         }
                                                                                                                                                                                                                                                                                                                                      sive commercial tools. It empowers biologists who do not possess
       </script>
                                                                                                                                                                                                                                                                                                                                      advanced computer skills to perform analysis and generate high-
   </head>                                                                                                                                                                                                                                                                                                                            quality publication-ready figures easily.
   <body onload¼“initPage();”>
   <canvas id¼“canvasId” width¼“540” height¼“540”></canvas>
                                                                                                                                                                                                                                                                                                                                      Conflict of Interest: none declared.

   </body></html>

   An advanced example with more data points and further cus-                                                                                                                                                                                                                                                                         References
tomization is available at https://goo.gl/XMGBHB.                                                                                                                                                                                                                                                                                     Ankenbrand,M.J. et al. (2016) TBro: visualization and management of de
   CanvasXpress can be now simply used within R at the console                                                                                                                                                                                                                                                                          novo transcriptomes. Database, 2016, baw146.
to generate conventional plots, in R-Studio, or seamlessly                                                                                                                                                                                                                                                                            Davenport,E.E. et al. (2017) Identification of drug eQTL interactions from re-
embedded in Shiny web applications. A list of examples of the                                                                                                                                                                                                                                                                           peat transcriptional and environmental measurements in a lupus clinical
canvasXpress R library including the mouse events, zooming and                                                                                                                                                                                                                                                                          trial. bioRxiv, 118703.
                                                                                                                                                                                                                                                                                                                                      Dower,K. et al. (2017) High resolution longitudinal analysis of renal disease
broadcasting capabilities are included under the shiny directory in
                                                                                                                                                                                                                                                                                                                                        progression in ZSF1 fa/faCP rats, a model of human type 2 diabetic nephr-
the github package (https://goo.gl/PDcAEN). This R library was
                                                                                                                                                                                                                                                                                                                                        opathy. Plos One, 12, e0181861.
created with the htmlwidgets package (http://www.htmlwidgets.
                                                                                                                                                                                                                                                                                                                                      Zhao,S. et al. (2016) QuickRNASeq lifts large-scale RNA-seq data analysis to
org).                                                                                                                                                                                                                                                                                                                                   next level of automation and visualization. BMC Genomics, 17, 39–43.
   Facilitated by canvasDesigner, the web-based graphics layout                                                                                                                                                                                                                                                                       Zhao,S. et al. (2017) QuickMIRSeq lifts joint quantification of known
tool written in JavaScript, the end user can easily arrange any num-                                                                                                                                                                                                                                                                    miRNAs and isomiRs from multiple samples to the next level of automation
ber of different types of plots in SVG format that can be exported by                                                                                                                                                                                                                                                                   and interactive visualization. BMC Bioinformatics, 18, 180–193.
